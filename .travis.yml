dist: trusty
language: cpp

os: linux

addons:
  apt:
      sources:
        - ubuntu-toolchain-r-test
      packages:
        - gcc-6
        - g++-6
        - doxygen
        - doxygen-doc
        - doxygen-latex
        - doxygen-gui
        - graphviz
        - imagemagick


before_install:
  - pip install --user cpp-coveralls


script:

  - cmake -H. -Bbuild
  - cd build
  - cmake --build -DENABLE_COVERAGE=ON -DCMAKE_CXX_COMPILER="g++-6" .
  - ctest -V
  - ./test/mainTest

after_success:
  - coveralls --root .. --verbose --exclude build/CMakeFiles/ --exclude build/googletest-src/ --exclude tests --gcov-options '\-lp'
# Generate and deploy documentation
  - cd $TRAVIS_BUILD_DIR
  - chmod +x generateDocumentationAndDeploy.sh
  - ./generateDocumentationAndDeploy.sh
# Environment variables
env:
  global:
    - GH_REPO_NAME: leistungsnachweis-cas
    - DOXYFILE: DOXYFILE=$TRAVIS_BUILD_DIR/Doxyfile
    - GH_REPO_REF: GH_REPO_REF=github.com/ob-algdatii-ss18/leistungsnachweis-cas.git


notifications:
  email: false